---
phase: 12-polish-recovery
plan: 02
type: execute
wave: 1
depends_on: ["12-01"]
status: completed
files_modified:
  - src/components/admin/correction/CorrectionModal.tsx
  - src/components/admin/correction/artist/ArtistCorrectionModal.tsx
  - src/components/admin/correction/shared/ModalSkeleton.tsx
  - src/components/admin/correction/apply/ApplyView.tsx
  - src/components/admin/correction/artist/apply/ArtistApplyView.tsx
autonomous: true

must_haves:
  truths:
    - "Modal shows skeleton while initial album/artist data loads"
    - "Apply button shows spinner during mutation"
    - "All loading states are visually consistent"
  artifacts:
    - path: "src/components/admin/correction/shared/ModalSkeleton.tsx"
      provides: "Skeleton for modal initial load"
      exports: ["ModalSkeleton"]
---

<objective>
Add loading skeletons for initial modal data fetch and loading spinners in mutation buttons.

Purpose: Users should see immediate visual feedback while data loads.
Output: Polished loading states across all correction modal views.
</objective>

<context>
@.planning/phases/12-polish-recovery/12-RESEARCH.md
@.planning/phases/12-polish-recovery/12-01-SUMMARY.md
@src/components/admin/correction/CorrectionModal.tsx
@src/components/admin/correction/artist/ArtistCorrectionModal.tsx
@src/components/admin/correction/apply/ApplyView.tsx
@src/components/admin/correction/artist/apply/ArtistApplyView.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create modal skeleton component</name>
  <files>
    src/components/admin/correction/shared/ModalSkeleton.tsx
    src/components/admin/correction/shared/index.ts
  </files>
  <action>
Create a skeleton that displays while the modal fetches initial album/artist data.

In ModalSkeleton.tsx:
- Match modal layout: step indicator area + content area
- Skeleton for step indicator (4 circles with labels)
- Skeleton for current data view (title, metadata, cover art placeholder)
- Use animate-pulse with zinc-700/zinc-800 colors
- Props: variant?: 'album' | 'artist' for slight differences

Update index.ts:
- Export ModalSkeleton
  </action>
  <verify>Run `pnpm type-check`</verify>
  <done>ModalSkeleton component created and exported</done>
</task>

<task type="auto">
  <name>Task 2: Integrate skeleton into album modal</name>
  <files>
    src/components/admin/correction/CorrectionModal.tsx
  </files>
  <action>
Show ModalSkeleton while album data is loading.

In CorrectionModal.tsx:
- Import ModalSkeleton from shared
- Check if albumDetailsQuery is loading
- Render ModalSkeleton when isLoading && !albumData
- Keep existing content rendering after data loads
  </action>
  <verify>Run `pnpm type-check`</verify>
  <done>Album modal shows skeleton during initial load</done>
</task>

<task type="auto">
  <name>Task 3: Integrate skeleton into artist modal</name>
  <files>
    src/components/admin/correction/artist/ArtistCorrectionModal.tsx
  </files>
  <action>
Show ModalSkeleton while artist data is loading.

In ArtistCorrectionModal.tsx:
- Import ModalSkeleton from shared (../../shared)
- Check if artistDetailsQuery is loading
- Render ModalSkeleton variant="artist" when loading
- Keep existing content rendering after data loads
  </action>
  <verify>Run `pnpm type-check`</verify>
  <done>Artist modal shows skeleton during initial load</done>
</task>

<task type="auto">
  <name>Task 4: Add loading spinners to apply buttons</name>
  <files>
    src/components/admin/correction/apply/ApplyView.tsx
    src/components/admin/correction/artist/apply/ArtistApplyView.tsx
  </files>
  <action>
Add Loader2 spinner inside apply buttons during mutation.

In ApplyView.tsx:
- Import Loader2 from lucide-react (if not already)
- Find "Apply Corrections" button
- Add spinner when isApplying: {isApplying ? <Loader2 className="h-4 w-4 animate-spin" /> : <CheckCircle className="h-4 w-4" />}
- Keep button disabled during apply

In ArtistApplyView.tsx:
- Same pattern: add Loader2 spinner when applying
- Swap icon based on isApplying state
  </action>
  <verify>Run `pnpm type-check && pnpm lint`</verify>
  <done>Apply buttons show spinner during mutation</done>
</task>

</tasks>

<verification>
```bash
pnpm type-check
pnpm lint
# Manual: Open correction modal, verify skeleton shows briefly, verify apply button spinner
```
</verification>

<success_criteria>
1. ModalSkeleton matches modal layout structure
2. Album modal shows skeleton while fetching album details
3. Artist modal shows skeleton while fetching artist details
4. Apply buttons show spinner during mutation
5. All loading states use consistent zinc color palette
</success_criteria>

<output>
After completion, create `.planning/phases/12-polish-recovery/12-02-SUMMARY.md`
</output>
