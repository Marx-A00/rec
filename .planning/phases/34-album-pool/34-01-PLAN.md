---
phase: 34-album-pool
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - prisma/schema.prisma
  - prisma/migrations/
autonomous: true

must_haves:
  truths:
    - "Album model has gameStatus field with three states"
    - "All existing albums default to NONE status"
    - "Prisma client generates with AlbumGameStatus enum"
  artifacts:
    - path: "prisma/schema.prisma"
      provides: "AlbumGameStatus enum and gameStatus field on Album"
      contains: "enum AlbumGameStatus"
    - path: "prisma/migrations/*_add_album_game_status/migration.sql"
      provides: "Migration SQL for gameStatus column"
  key_links:
    - from: "prisma/schema.prisma"
      to: "Album model"
      via: "gameStatus field"
      pattern: "gameStatus.*AlbumGameStatus.*@default\\(NONE\\)"
---

<objective>
Add AlbumGameStatus enum and gameStatus field to the Album model for tracking game pool eligibility.

Purpose: Foundation for the curated album pool system - albums can be marked as ELIGIBLE (in pool), EXCLUDED (blocked), or NONE (not reviewed).

Output: Prisma migration applied, AlbumGameStatus enum available in generated client.
</objective>

<execution_context>
@/Users/marcosandrade/.claude/get-shit-done/workflows/execute-plan.md
@/Users/marcosandrade/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/34-album-pool/34-CONTEXT.md
@prisma/schema.prisma
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add AlbumGameStatus enum and gameStatus field to Album model</name>
  <files>prisma/schema.prisma</files>
  <action>
Add the AlbumGameStatus enum with three values:

```prisma
enum AlbumGameStatus {
  ELIGIBLE   // Approved for game pool
  EXCLUDED   // Explicitly blocked from pool
  NONE       // Neutral, not yet reviewed (default)
}
```

Add gameStatus field to the Album model with default NONE:

```prisma
model Album {
  // ... existing fields
  gameStatus            AlbumGameStatus       @default(NONE) @map("game_status")
  // ... rest of model
}
```

Place the enum near other enums (after EnrichmentStatus or similar).
Place the field after the metadata field in the Album model.
  </action>
  <verify>
Run `pnpm prisma validate` to confirm schema is valid.
  </verify>
  <done>
AlbumGameStatus enum exists with ELIGIBLE/EXCLUDED/NONE values. Album model has gameStatus field with @default(NONE).
  </done>
</task>

<task type="auto">
  <name>Task 2: Run migration and verify types</name>
  <files>prisma/migrations/</files>
  <action>
Run Prisma migration to add the gameStatus column:

```bash
pnpm prisma migrate dev --name add_album_game_status
```

This will:
1. Create the AlbumGameStatus enum in PostgreSQL
2. Add game_status column to albums table with default 'NONE'
3. Regenerate Prisma client with new types

After migration completes, verify:
1. `pnpm type-check` passes
2. `pnpm prisma generate` succeeds
3. AlbumGameStatus enum is exported from @prisma/client
  </action>
  <verify>
Run `pnpm type-check` - should pass with no errors.
Check migration SQL file exists and contains CREATE TYPE and ALTER TABLE statements.
  </verify>
  <done>
Migration applied successfully. TypeScript types include AlbumGameStatus. All existing albums have gameStatus = NONE.
  </done>
</task>

</tasks>

<verification>
1. `pnpm prisma validate` passes
2. Migration file exists in prisma/migrations/
3. `pnpm type-check` passes
4. `grep -r "AlbumGameStatus" node_modules/.prisma/client/index.d.ts` returns results
</verification>

<success_criteria>
- AlbumGameStatus enum with three values (ELIGIBLE, EXCLUDED, NONE) exists in schema
- Album model has gameStatus field with @default(NONE)
- Migration applied without errors
- Prisma client types include AlbumGameStatus
- All existing albums have gameStatus = NONE (verified via default)
</success_criteria>

<output>
After completion, create `.planning/phases/34-album-pool/34-01-SUMMARY.md`
</output>
