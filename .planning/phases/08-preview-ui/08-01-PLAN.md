---
phase: 08-preview-ui
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/admin/correction/preview/PreviewView.tsx
  - src/components/admin/correction/preview/ComparisonLayout.tsx
  - src/components/admin/correction/preview/PreviewSkeleton.tsx
  - src/components/admin/correction/preview/index.ts
autonomous: true

must_haves:
  truths:
    - "PreviewView renders loading skeleton while fetching"
    - "PreviewView shows error state on query failure"
    - "Two-column layout displays Current vs MusicBrainz side-by-side"
  artifacts:
    - path: "src/components/admin/correction/preview/PreviewView.tsx"
      provides: "Main preview container with GraphQL integration"
      min_lines: 80
    - path: "src/components/admin/correction/preview/ComparisonLayout.tsx"
      provides: "Two-column grid layout component"
      min_lines: 25
    - path: "src/components/admin/correction/preview/PreviewSkeleton.tsx"
      provides: "Loading skeleton for preview"
      min_lines: 40
  key_links:
    - from: "src/components/admin/correction/preview/PreviewView.tsx"
      to: "GetCorrectionPreview GraphQL query"
      via: "useGetCorrectionPreviewQuery"
      pattern: "useGetCorrectionPreviewQuery"
---

<objective>
Create the PreviewView container and layout foundation for side-by-side album comparison.

Purpose: Establishes the preview shell that fetches diff data from GraphQL and renders two-column comparison layout.
Output: PreviewView component ready to host field/track comparisons (Plans 08-02 and 08-03).
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/08-preview-ui/08-CONTEXT.md
@.planning/phases/08-preview-ui/08-RESEARCH.md

# Prior work
@.planning/phases/07-search-ui/07-03-SUMMARY.md

# Key patterns
@src/components/admin/correction/CurrentDataView.tsx
@src/graphql/queries/correctionPreview.graphql
@src/hooks/useCorrectionModalState.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create preview module structure and ComparisonLayout</name>
  <files>
    src/components/admin/correction/preview/ComparisonLayout.tsx
    src/components/admin/correction/preview/index.ts
  </files>
  <action>
Create the preview subdirectory structure under correction/.

**ComparisonLayout.tsx:**
- Props: `{ current: React.ReactNode, source: React.ReactNode }`
- Two-column grid using Tailwind: `grid grid-cols-2 gap-6`
- Left column header: "Current" (text-sm font-medium text-zinc-400 uppercase)
- Right column header: "MusicBrainz Source" (same styling)
- Each column wraps children in `space-y-4` container
- Follow dark zinc color scheme from CurrentDataView

**index.ts:**
- Barrel export for preview module components
- Export ComparisonLayout (PreviewView and PreviewSkeleton added in later tasks)
  </action>
  <verify>
TypeScript compiles: `pnpm type-check`
Component can be imported: `import { ComparisonLayout } from './preview'`
  </verify>
  <done>
ComparisonLayout renders side-by-side columns with headers and accepts any React children.
  </done>
</task>

<task type="auto">
  <name>Task 2: Create PreviewSkeleton loading state</name>
  <files>
    src/components/admin/correction/preview/PreviewSkeleton.tsx
    src/components/admin/correction/preview/index.ts
  </files>
  <action>
**PreviewSkeleton.tsx:**
Create a loading skeleton that mimics the preview layout structure.

Structure:
- Two-column grid matching ComparisonLayout
- Each column contains:
  - Header placeholder (w-24 h-4 skeleton)
  - Cover art placeholder (w-32 h-32 skeleton)
  - 5-6 field row placeholders (varied widths: w-48, w-36, w-52)
  - Track section header placeholder
  - 4-5 track row placeholders

Use Tailwind animate-pulse on bg-zinc-800 rounded elements.
Match the visual structure of what PreviewView will render.

**Update index.ts:**
- Add PreviewSkeleton to barrel exports
  </action>
  <verify>
TypeScript compiles: `pnpm type-check`
Skeleton shows pulsing placeholders matching preview structure.
  </verify>
  <done>
PreviewSkeleton displays realistic loading state for preview content.
  </done>
</task>

<task type="auto">
  <name>Task 3: Create PreviewView container with GraphQL integration</name>
  <files>
    src/components/admin/correction/preview/PreviewView.tsx
    src/components/admin/correction/preview/index.ts
  </files>
  <action>
**PreviewView.tsx:**

Props interface:
```typescript
interface PreviewViewProps {
  albumId: string;
  releaseGroupMbid: string;
}
```

Implementation:
1. **GraphQL Query**: Use `useGetCorrectionPreviewQuery` from generated hooks
   - Input: `{ albumId, releaseGroupMbid }`
   - Enable query only when both props are truthy

2. **Loading State**: Render PreviewSkeleton while `isLoading`

3. **Error State**: Show error message in centered container
   - "Failed to load preview data"
   - Red text, similar pattern to CorrectionModal error states

4. **Success State**: 
   - Extract `preview = data?.correctionPreview`
   - Guard against null preview (show "Preview data not available")
   - Render ComparisonLayout as shell (content components in Plan 08-02/03)
   - Left column: placeholder text "Current data" 
   - Right column: placeholder text "MusicBrainz source"
   - Add header section with cover art placeholders (two 128x128 divs side by side)

5. **Dark zinc theme**: bg-zinc-900 backgrounds, zinc-700 borders

**Key data extraction for later plans:**
- `preview.fieldDiffs` - for field comparisons
- `preview.artistDiff` - for artist comparison
- `preview.trackDiffs` / `preview.trackSummary` - for track comparison
- `preview.coverArt` - for cover art comparison
- `preview.summary` - for change counts

For now, just wire up the query and render placeholders. Actual field/track components come in Plans 08-02 and 08-03.

**Update index.ts:**
- Add PreviewView to barrel exports
  </action>
  <verify>
TypeScript compiles: `pnpm type-check`
ESLint passes: `pnpm lint`
Query executes when props provided (can test by temporarily adding to CorrectionModal step 2)
  </verify>
  <done>
PreviewView fetches correction preview data and renders loading/error/placeholder states.
  </done>
</task>

</tasks>

<verification>
- `pnpm type-check` passes
- `pnpm lint` passes
- Preview module exports all three components
- PreviewView correctly types GetCorrectionPreviewQuery response
</verification>

<success_criteria>
1. ComparisonLayout renders two equal columns with headers
2. PreviewSkeleton shows realistic loading animation
3. PreviewView fetches data via GraphQL and shows appropriate states
4. All components follow dark zinc color scheme
5. Module exports work: `import { PreviewView, ComparisonLayout, PreviewSkeleton } from './preview'`
</success_criteria>

<output>
After completion, create `.planning/phases/08-preview-ui/08-01-SUMMARY.md`
</output>
