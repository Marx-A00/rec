---
phase: 27-code-rename
plan: 05
type: execute
wave: 5
depends_on: ["27-03", "27-04"]
files_modified: []
autonomous: true

must_haves:
  truths:
    - "Admin can view llama logs in admin UI without errors"
    - "Log queries return data using llamaLogs field without GraphQL errors"
    - "pnpm check-all passes (type-check, lint, format)"
    - "Zero stale EnrichmentLog references in TypeScript source files"
  artifacts:
    - path: "verification-output"
      provides: "Clean grep results showing no stale references"
      min_lines: 0
  key_links:
    - from: "src/components/admin/EnrichmentLogTable.tsx"
      to: "src/generated/graphql.ts"
      via: "useGetLlamaLogsQuery hook"
      pattern: "useGetLlamaLogsQuery"
    - from: "src/lib/graphql/resolvers/queries.ts"
      to: "prisma.llamaLog"
      via: "Prisma client calls"
      pattern: "prisma\\.llamaLog\\."
---

<objective>
Final verification that all EnrichmentLog references are removed and the system works correctly.

Purpose: Confirm the phase success criteria are met: no EnrichmentLog references, TypeScript compiles, admin UI works.
Output: Verification results confirming phase completion.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/27-code-rename/27-01-SUMMARY.md
@.planning/phases/27-code-rename/27-02-SUMMARY.md
@.planning/phases/27-code-rename/27-03-SUMMARY.md
@.planning/phases/27-code-rename/27-04-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify no EnrichmentLog references remain</name>
  <files>None (verification only)</files>
  <action>
  Run comprehensive search for stale references:

  1. Search for EnrichmentLog type (case-sensitive):
  ```bash
  grep -r "EnrichmentLog" src/ --include="*.ts" --include="*.tsx" | grep -v "node_modules" | grep -v ".planning"
  ```
  Should return empty (no matches).

  2. Search for enrichmentLog property (Prisma calls):
  ```bash
  grep -r "enrichmentLog" src/ --include="*.ts" --include="*.tsx" | grep -v "node_modules" | grep -v ".planning"
  ```
  Should return empty (no matches).

  3. Search for EnrichmentLogger class:
  ```bash
  grep -r "EnrichmentLogger" src/ --include="*.ts" --include="*.tsx" | grep -v "node_modules" | grep -v ".planning"
  ```
  Should return empty (no matches).

  4. Search for old import path:
  ```bash
  grep -r "enrichment-logger" src/ --include="*.ts" --include="*.tsx" | grep -v "node_modules" | grep -v ".planning"
  ```
  Should return empty (no matches).

  5. Verify file deletion:
  ```bash
  ls src/lib/enrichment/enrichment-logger.ts
  ```
  Should return "No such file" error.

  If any matches found, list the files that need updating and fix them.
  </action>
  <verify>
  Run deterministic check - ALL must return 0:
  
  1. `grep -r "EnrichmentLog" src/ --include="*.ts" --include="*.tsx" | grep -v "prisma/migrations" | wc -l` → must be 0
  2. `grep -r "enrichmentLog" src/ --include="*.ts" --include="*.tsx" | grep -v "prisma/migrations" | wc -l` → must be 0
  3. `grep -r "EnrichmentLogger" src/ --include="*.ts" --include="*.tsx" | wc -l` → must be 0
  4. `grep -r "enrichment-logger" src/ --include="*.ts" --include="*.tsx" | wc -l` → must be 0
  5. `ls src/lib/enrichment/enrichment-logger.ts 2>&1 | grep -c "No such file"` → must be 1
  
  If any check fails, fix the files before proceeding.
  </verify>
  <done>All stale reference checks return 0, old file confirmed deleted</done>
</task>

<task type="auto">
  <name>Task 2: Full TypeScript and lint verification</name>
  <files>None (verification only)</files>
  <action>
  Run full codebase checks:

  1. TypeScript type checking:
  ```bash
  pnpm type-check
  ```
  Should exit with code 0 (no errors).

  2. ESLint:
  ```bash
  pnpm lint
  ```
  Should pass (warnings OK, errors not OK).

  3. Full check:
  ```bash
  pnpm check-all
  ```
  Should pass all checks.

  If any errors:
  1. Read error output
  2. Identify which files have issues
  3. Fix the issues
  4. Re-run checks
  </action>
  <verify>
  Run deterministic checks - ALL must pass:
  
  1. `pnpm type-check && echo "PASS" || echo "FAIL"` → must output PASS
  2. `pnpm lint && echo "PASS" || echo "FAIL"` → must output PASS (warnings OK)
  3. `pnpm check-all && echo "PASS" || echo "FAIL"` → must output PASS
  
  If any check fails, fix errors before proceeding.
  </verify>
  <done>pnpm check-all passes with exit code 0</done>
</task>

<task type="checkpoint:manual">
  <name>Task 3: Verify admin UI loads correctly</name>
  <files>None (manual verification)</files>
  <action>
  This task requires manual verification of the admin UI.

  1. Start dev server (if not running):
  ```bash
  pnpm dev
  ```

  2. Open admin page: http://localhost:3000/admin/music-database

  3. Verify the following manually:
     - Page loads without JavaScript errors (check browser console)
     - Log table displays data (if any logs exist in database)
     - No runtime errors in console related to LlamaLog/EnrichmentLog
     - GraphQL queries execute successfully (check Network tab for /api/graphql)

  4. If issues found:
     - Check browser console for specific errors
     - Check Network tab for GraphQL errors
     - Report issues for fixing before marking complete
  </action>
  <verify>
  User confirms:
  - Admin page at /admin/music-database loads without console errors
  - Log table renders (with data or empty state)
  - No GraphQL query failures in Network tab
  </verify>
  <done>User has confirmed admin UI loads and displays log data correctly</done>
</task>

</tasks>

<verification>
1. No stale references:
   - All grep searches return empty
   - Old enrichment-logger.ts file is deleted

2. Code quality:
   - `pnpm type-check` passes
   - `pnpm lint` passes
   - `pnpm check-all` passes

3. Runtime verification:
   - Admin UI loads without errors
   - Log data displays correctly
   - GraphQL queries work

4. Phase requirements met:
   - CODE-01: Logger class renamed (LlamaLogger)
   - CODE-02: Logger file moved (src/lib/logging/llama-logger.ts)
   - CODE-03: All prisma.enrichmentLog calls updated
   - CODE-04: All type imports updated
   - CODE-05: GraphQL schema types updated
   - CODE-06: GraphQL types regenerated
   - CODE-07: All resolver references updated
</verification>

<success_criteria>
- Zero EnrichmentLog references in TypeScript source files
- Zero EnrichmentLogger references in codebase
- pnpm check-all passes
- Admin UI loads and functions correctly
- Phase 27 requirements CODE-01 through CODE-07 are complete
</success_criteria>

<output>
After completion, create `.planning/phases/27-code-rename/27-05-SUMMARY.md`
</output>
