---
phase: 07-search-ui
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/admin/correction/search/SearchResultCard.tsx
  - src/components/admin/correction/search/SearchResults.tsx
  - src/components/admin/correction/search/NoResultsState.tsx
  - src/components/admin/correction/search/index.ts
autonomous: true

must_haves:
  truths:
    - "Each result shows title, artist, year, release type"
    - "Each result shows match score as percentage"
    - "Each result shows [MB] source badge"
    - "Each result shows album thumbnail (48px)"
    - "Results sorted by score highest first"
    - "Load more button appears when hasMore is true"
    - "No results state shows Manual Edit link"
  artifacts:
    - path: "src/components/admin/correction/search/SearchResultCard.tsx"
      provides: "Clickable result row with all metadata"
      exports: ["SearchResultCard"]
    - path: "src/components/admin/correction/search/SearchResults.tsx"
      provides: "Results list container with Load more"
      exports: ["SearchResults"]
    - path: "src/components/admin/correction/search/NoResultsState.tsx"
      provides: "Empty state with Manual Edit link"
      exports: ["NoResultsState"]
  key_links:
    - from: "SearchResultCard"
      to: "onClick callback"
      via: "button click"
      pattern: "onClick.*result"
    - from: "SearchResults"
      to: "onLoadMore callback"
      via: "Load more button"
      pattern: "onClick.*onLoadMore"
---

<objective>
Create search results display components for the correction modal.

Purpose: Admin needs to see search results with enough detail to identify the correct album. This plan creates the result card with metadata + match score, the results list with pagination, and the no-results fallback state.

Output: SearchResultCard, SearchResults with Load more, NoResultsState
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/07-search-ui/07-CONTEXT.md
@.planning/phases/07-search-ui/07-RESEARCH.md

@src/lib/correction/types.ts
@src/lib/correction/scoring/types.ts
@src/components/ui/AlbumImage.tsx
@src/components/ui/badge.tsx
@src/components/ui/button.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create SearchResultCard with metadata and match score</name>
  <files>
    src/components/admin/correction/search/SearchResultCard.tsx
  </files>
  <action>
Create SearchResultCard.tsx:

1. Props interface:
   - result: ScoredSearchResult (from @/lib/correction/scoring/types)
   - onClick: (result: ScoredSearchResult) => void

2. Layout as full-width button:
   - Flex row with gap-3, p-3
   - Hover state: bg-zinc-800/50
   - Active state: bg-zinc-800
   - Transition colors duration-150
   - text-left alignment

3. Content structure:
   Left: AlbumImage (48x48px, rounded, flex-shrink-0)
   - src: result.coverArtUrl
   - showSkeleton: false (results already loaded)

   Right: Metadata stack
   - Row 1: Title (font-medium text-cosmic-latte truncate) + Score (text-sm font-semibold text-emeraled-green)
     Score format: `{Math.round(result.normalizedScore * 100)}% match`
   - Row 2: Artist + Year (text-sm text-zinc-400 truncate)
     Format: `{primaryArtistName} â€¢ {firstReleaseDate?.split('-')[0]}`
   - Row 3: Metadata (text-xs text-zinc-500)
     - primaryType (if present)
     - secondaryTypes (if present, join with ", ")
     - [MB] badge (ml-auto, variant="outline", text-zinc-500 border-zinc-700)

   Note: trackCount is NOT available at search time (MusicBrainz release group search does not return it). Track count will be shown in the Preview step (Phase 8) which fetches full release data.

4. Accessibility:
   - Use <button> element for full row click
   - aria-label with album title

Key decisions from CONTEXT.md:
- Single click anywhere on row selects and navigates to preview
- Subtle hover state (light background change)
- Score positioned near title, prominently visible
- Source badge subtle gray text
  </action>
  <verify>
pnpm type-check passes
Component renders result data correctly
  </verify>
  <done>
SearchResultCard displays thumbnail, title with score, artist/year, metadata row with release type and [MB] badge, full row clickable
  </done>
</task>

<task type="auto">
  <name>Task 2: Create SearchResults container and NoResultsState</name>
  <files>
    src/components/admin/correction/search/SearchResults.tsx
    src/components/admin/correction/search/NoResultsState.tsx
    src/components/admin/correction/search/index.ts
  </files>
  <action>
Create SearchResults.tsx:

1. Props interface:
   - results: GroupedSearchResult[] (from @/lib/correction/types)
   - hasMore: boolean
   - isLoadingMore: boolean
   - onResultClick: (result: ScoredSearchResult) => void
   - onLoadMore: () => void
   - onManualEdit: () => void

2. Conditional rendering:
   - If results.length === 0: render NoResultsState with onManualEdit
   - Otherwise: render list + optional Load more button

3. Results list:
   - Map over results, render SearchResultCard for each primaryResult
   - Pass result.primaryResult to SearchResultCard
   - Use result.releaseGroupMbid as key

4. Load more button (only when hasMore && !isLoadingMore):
   - Full width, variant="outline"
   - Text: "Load more results"
   - Disabled when isLoadingMore
   - When isLoadingMore, show spinner + "Loading..."

Create NoResultsState.tsx:

1. Props interface:
   - onManualEdit: () => void

2. Layout (flex-col items-center justify-center py-12 text-center):
   - AlertCircle icon (h-12 w-12 text-zinc-600 mb-4) from lucide-react
   - Heading: "No results found" (text-lg font-medium text-cosmic-latte mb-2)
   - Description: "We couldn't find any matches in MusicBrainz. Try adjusting your search or enter the data manually." (text-sm text-zinc-400 mb-6 max-w-sm)
   - Button: "Manual Edit" (variant="outline", onClick={onManualEdit})

Update index.ts:
```tsx
export { SearchInputs } from './SearchInputs';
export { SearchSkeleton } from './SearchSkeleton';
export { SearchResultCard } from './SearchResultCard';
export { SearchResults } from './SearchResults';
export { NoResultsState } from './NoResultsState';
```

Key decisions from CONTEXT.md:
- Show first 10 results, then Load more at bottom
- Results always sorted by score (done by backend)
- No results state links to Manual Edit as escape hatch
  </action>
  <verify>
pnpm type-check passes
All components export correctly from index.ts
  </verify>
  <done>
SearchResults renders list with Load more pagination, NoResultsState provides empty state with Manual Edit link
  </done>
</task>

</tasks>

<verification>
- pnpm type-check passes
- pnpm lint passes (run pnpm lint:fix if needed)
- SearchResultCard displays all required fields (title, artist, year, type, score, [MB] badge)
- SearchResults handles empty state and pagination
- NoResultsState provides escape hatch to Manual Edit
</verification>

<success_criteria>
1. SearchResultCard shows all metadata with proper styling
2. Match score displayed as percentage near title
3. [MB] badge visible but subtle
4. Full row is clickable with hover state
5. Load more button appears when hasMore true
6. No results state shows helpful message + Manual Edit link
</success_criteria>

<output>
After completion, create `.planning/phases/07-search-ui/07-02-SUMMARY.md`
</output>
