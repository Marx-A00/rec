/* Driver.js Custom Theme - Matching Rec Design System */

/* Popover Container */
.driver-popover {
  @apply bg-zinc-900 border-2 border-zinc-700 rounded-xl shadow-2xl;
  max-width: 420px !important;
  pointer-events: auto !important; /* Allow interactions within popover */
}

/* Large popover variant for step 3 */
.driver-popover-large {
  max-width: 600px !important;
  min-width: 500px !important;
  padding: 2rem !important;
}

.driver-popover-large .driver-popover-title {
  font-size: 1.75rem !important;
  margin-bottom: 1.5rem !important;
}

.driver-popover-large .driver-popover-description {
  font-size: 1.125rem !important;
  line-height: 1.8 !important;
  margin-bottom: 2rem !important;
}

/* Wide bottom popover variant for step 4 - sits at bottom without covering elements */
.driver-popover-wide-bottom {
  max-width: 800px !important;
  min-width: 700px !important;
  padding: 1.5rem 2rem !important;
}

.driver-popover-wide-bottom .driver-popover-title {
  font-size: 1.25rem !important;
  margin-bottom: 0.75rem !important;
}

.driver-popover-wide-bottom .driver-popover-description {
  font-size: 0.95rem !important;
  line-height: 1.5 !important;
  margin-bottom: 1rem !important;
}

/* Allow scrolling through popover when it's not being interacted with */
.driver-popover-wrapper {
  pointer-events: none !important;
}

.driver-popover-wrapper .driver-popover {
  pointer-events: auto !important;
}

/* Title */
.driver-popover-title {
  @apply text-xl font-bold text-white mb-3;
  font-size: 1.25rem !important;
}

/* Description */
.driver-popover-description {
  @apply text-zinc-300 text-sm leading-relaxed mb-6;
  line-height: 1.6 !important;
}

/* Footer */
.driver-popover-footer {
  @apply pt-4 border-t border-zinc-800;
}

/* Progress Text */
.driver-popover-progress-text {
  @apply text-xs text-zinc-500 font-medium;
}

/* Buttons */
.driver-popover-next-btn,
.driver-popover-prev-btn,
.driver-popover-close-btn {
  @apply px-4 py-2 text-sm rounded-lg font-medium transition-colors;
  border: none !important;
  outline: none !important;
}

.driver-popover-next-btn {
  @apply bg-emerald-600 hover:bg-emerald-700 text-white shadow-lg;
}

.driver-popover-prev-btn {
  @apply bg-zinc-700 hover:bg-zinc-600 text-zinc-300;
}

.driver-popover-close-btn {
  @apply text-zinc-400 hover:text-white;
  background: transparent !important;
  padding: 0.5rem !important;
  cursor: pointer !important;
  z-index: 10 !important;
  position: relative !important;
}

.driver-popover-close-btn:hover {
  @apply text-white bg-zinc-800;
  border-radius: 0.375rem;
}

/* Arrow */
.driver-popover-arrow {
  @apply border-zinc-700;
}

.driver-popover-arrow-side-left.driver-popover-arrow {
  border-right-color: #3f3f46 !important; /* zinc-700 */
}

.driver-popover-arrow-side-right.driver-popover-arrow {
  border-left-color: #3f3f46 !important;
}

.driver-popover-arrow-side-top.driver-popover-arrow {
  border-bottom-color: #3f3f46 !important;
}

.driver-popover-arrow-side-bottom.driver-popover-arrow {
  border-top-color: #3f3f46 !important;
}

/* Highlighted Element */
.driver-active-element {
  @apply ring-2 ring-cosmic-latte ring-offset-2 ring-offset-zinc-900;
  /* Force full brightness */
  background-color: inherit !important;
  color: inherit !important;
}

/* Only boost z-index for specific tour elements, not body */
.driver-active-element[data-tour-step] {
  position: relative !important;
  z-index: 10001 !important; /* Above the driver overlay */
  /* Ensure it's not dimmed */
  opacity: 1 !important;
  filter: brightness(1.2) !important; /* Make it slightly brighter */
}

/* Ensure highlighted element's children stay visible and bright */
/* REMOVED global position: relative on all children - it breaks absolute positioning in components like similarity dial */
.driver-active-element[data-tour-step] * {
  /* position: relative; ‚Üê COMMENTED OUT - causes displacement */
  z-index: inherit;
  opacity: 1 !important;
}

/* Exception: Prevent Driver.js from forcing position/layout changes on turntable wrapper */
.driver-active-element[data-tour-step="recommendation-interface-wrapper"] {
  position: static !important;
  ring-offset: 0 !important;
  transform: none !important;
}

.driver-active-element[data-tour-step="recommendation-interface-wrapper"] * {
  position: static !important;
  transform: none !important;
}


/* Exception: Keep turntable labels absolutely positioned during tour */
.driver-active-element .tour-label-fix {
  position: absolute !important;
}


/* Overlay - Completely transparent by default, but can be dimmed per-step */
.driver-overlay {
  background-color: rgba(0, 0, 0, 0.75) !important;
  backdrop-filter: none;
  opacity: 0;
  transition: opacity 0.3s ease-in-out;
}

/* The "stage" is the highlighted area cutout - ensure it's fully visible */
#driver-highlighted-element-stage,
#driver-page-overlay {
  pointer-events: none !important;
}

/* Allow scrolling within highlighted elements and their children */
.driver-active-element,
.driver-active-element * {
  pointer-events: auto !important;
}

/* Make sure highlighted elements are NOT affected by the overlay */
.driver-active-element {
  opacity: 1 !important;
  filter: none !important;
}

/* Animation */
.driver-popover {
  animation: popoverFadeIn 0.2s ease-in-out;
}

@keyframes popoverFadeIn {
  from {
    opacity: 0;
    transform: scale(0.95);
  }
  to {
    opacity: 1;
    transform: scale(1);
  }
}
