#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸš€ Running pre-push checks..."

# Check if we're pushing to main/master
protected_branch='main'
current_branch=$(git symbolic-ref HEAD | sed -e 's,.*/\(.*\),\1,')

if [ $current_branch = $protected_branch ]; then
    echo "ğŸ›¡ï¸  Pushing to protected branch $protected_branch"
    echo "ğŸ”„ Running full test suite..."
    
    # Type checking
    echo "ğŸ“ Type checking..."
    pnpm type-check
    
    # Linting
    echo "ğŸ” Linting..."
    pnpm lint
    
    # Format check
    echo "ğŸ¨ Format checking..."
    pnpm format:check
    
    # Build check
    echo "ğŸ—ï¸  Build checking..."
    pnpm build
    
    echo "âœ… All checks passed! Pushing to $protected_branch"
else
    echo "ğŸ“ Quick checks for feature branch..."
    pnpm type-check && pnpm lint
fi 